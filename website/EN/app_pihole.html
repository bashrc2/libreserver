<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="libreserver.css" />
    <link rel="manifest" href="manifest.json" />
    <title>libreserver</title>
  </head>
  <body>
    <br />
    <a href="apps.html"><h1><span class="titlePrefix">Libre</span>Server</h1></a>
    <div class="subtitle">Pihole</div>
    <div class="networkImage">
      <img src="images/internet.png" />
    </div>

    <div class="projectDescription">

      <p>
	Pompous people who have an inflated sense of self-entitlement will tell you that it's <i>your moral duty</i> to view their mind-numbingly tedious corporate ads on their web site or YouTube channel, or else their kids will starve and the sky will fall because their revenue stream will dry up. But that's bullshit. There is nothing intrinsic or morally mandatory about adverts propping up the livelihoods of netizens, and indeed a web not primarily based on advertising money might have been a much better and more interesting place by now, with a lot less spying.
      </p>

      <p>
	Not only are web ads annoying, but they can consume a lot of bandwidth, be a privacy problem in terms of allowing companies to track your browsing habits and also any badly written scripts they contain may introduce exploitable security holes. Also if you're poor then adverts often make you want things that you can't have.
      </p>

      <p>
	You can block ads for any devices connected to your local network by installing the <b>pihole</b> app from <b>Add/Remove Apps</b> on the administrator control panel. This may help to improve overall performance of your devices by not wasting time downloading unwanted images or scripts.
      </p>

      <p>
	Also don't expect perfection. Though many ads may be blocked by this system some will still get through. It's a constant cat and mouse game between advertisers and blockers.
      </p>

      <h2>Set a static IP address</h2>
      <p>
	Ensure that your system has a static local IP address (typically 192.168..) using the option on the control panel. You will also need to know the IP address of your internet router, which is usually <b>192.168.1.1</b> or <b>192.168.1.254</b>.
      </p>

      <p>
	When that's done select <b>About this system</b> from the control panel and see the IPv4 address. You can use this as a DNS address in two ways:
      </p>

      <h2>On each client system within your local network</h2>
      <p>
	Make sure that you add the static IP address for the server to <b>/etc/hosts</b>.
      </p>

      <pre>
	STATIC_IP=[your server static IP]
	sudo echo "$STATIC_IP [your domain name]" >> /etc/hosts</pre>

      <p>
	On Arch/Parabola:
      </p>

      <pre>
	sudo pacman -S openresolv
	sudo sed -i "s|#name_servers=.*|name_servers=$STATIC_IP|g" /etc/resolvconf.conf
	sudo sed -i "s|name_servers=.*|name_servers=$STATIC_IP|g" /etc/resolvconf.conf
	sudo chattr -i /etc/resolv.conf
	sudo resolvconf -u
      </pre>

      <p>
	Or on a Debian based system:
      </p>

      <pre>
	sudo apt-get install resolvconf
	echo 'domain localdomain' > /tmp/resolvconf
	echo 'search localdomain' >> /tmp/resolvconf
	echo "nameserver $STATIC_IP" >> /tmp/resolvconf
	sudo mv /tmp/resolvconf /etc/resolvconf/resolv.conf.d/head
	sudo chattr -i /etc/resolv.conf
	sudo resolvconf -u
      </pre>

      <h2>On your internet router</h2>
      <p>
	If you can access the settings on your local internet router then this is the simplest way to provide ad blocking for all devices which connect to it. Unfortunately some router models don't let you edit the DNS settings and if that's the case you might want to consider getting a different router.
      </p>

      <p>
	Edit the DNS settings and add the IPv4 address which you got from the control panel About screen. Exactly how you do this will just depend upon your particular router model. You may also need to set the same address twice, because two addresses are conventional.
      </p>

      <h3>LibreCMC</h3>
      <p>
	On a router running LibreCMC from the <b>Network</b> menu select <b>DHCP and DNS</b>. Enter the static IP address of your LibreServer system within <b>DNS Forwardings</b>, then at the bottom of the page click on <b>Save &amp; Apply</b>. Any devices which connect to your router will now have ad blocking.
      </p>

      <h2>Configuring block lists</h2>
      <p>
	You can configure the block lists which the system uses by going to the <b>administrator control panel</b>, selecting <b>App Settings</b> then choosing <b>pihole</b>. You can also add any extra domain names to the whitelist if they're being wrongly blocked or to the blacklist if they're not blocked by the current lists.
      </p>
    </div>
  </body>
</html>
